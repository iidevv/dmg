{"version":3,"sources":["webpack:///./assets/js/theme/product.js","webpack:///./assets/js/theme/common/models/forms.js","webpack:///./assets/js/theme/common/form-utils.js","webpack:///./assets/js/theme/global/compare-products.js","webpack:///./assets/js/theme/product/reviews.js","webpack:///./assets/js/theme/product/video-gallery.js","webpack:///./assets/js/theme/themevale/themevale_stickyAddToCart.js","webpack:///./assets/js/theme/themevale/themevale_fbt.js"],"names":["Product","context","url","window","location","href","$reviewLink","$","onReady","validator","compareProducts","this","urls","document","on","indexOf","history","replaceState","title","pathname","collapsibleFactory","product_id","val","Countdown","productDetails","ProductDetails","BCData","product_attributes","setProductVariant","videoGallery","$reviewForm","classifyForm","review","Review","registerValidation","performCheck","areAll","productReviewHandler","stickyAddToCart","FBT","length","descriptionSlider","event","slick","descriptionSlider2","trigger","dots","arrows","infinite","slidesToShow","slidesToScroll","mobileFirst","responsive","breakpoint","settings","PageManager","forms","email","value","test","password","notEmpty","inputTagNames","formSelector","options","$form","$inputs","find","join","formFieldClass","each","__","input","specificClassName","$input","$formField","parent","tagName","prop","toLowerCase","className","inputType","addClass","classifyInput","insertStateHiddenField","$stateField","stateFieldAttrs","type","name","$field","fieldId","match","getFieldId","after","Validators","setEmailValidation","field","add","selector","validate","cb","errorMessage","setPasswordValidation","passwordSelector","password2Selector","requirements","isOptional","$password","passwordValidations","result","RegExp","alpha","numeric","minlength","error","setMinMaxPriceValidation","selectors","errorSelector","fieldsetSelector","maxPriceSelector","minPriceSelector","configure","form","preventSubmit","successClass","setMessageOptions","errorSpan","setStateCountryValidation","cleanUpStateValidation","$fieldClassElement","data","Object","keys","nod","classes","forEach","hasClass","removeClass","updateCounterNav","counter","$link","urlContext","is","attr","compare","html","products","$checked","$compareLink","element","compareCounter","item","product","currentTarget","$clickedCompareLink","checked","push","index","splice","decrementCounter","showAlertModal","preventDefault","submit","$reviewsContent","$collapsible","$collapsible2","initLinkBind","injectPaginationLink","collapseReviews","$content","$content2","e","CollapsibleEvents","click","width","animate","scrollTop","offset","top","height","hash","$nextLink","$prevLink","reviewRating","reviewSubject","reviewComment","reviewEmail","VideoGallery","$element","$player","$videos","currentVideo","bindEvents","selectNewVideo","$target","id","$selectedThumb","setMainVideo","setActiveThumb","bind","$el","scroll","css","outerHeight","toggleClass","onload","previewModal","modalFactory","showList","list","response","append","trim","pId","hasOptions","hasDefaultOptions","utils","api","productAttributes","optionChange","serialize","err","attributesData","attributesContent","content","updateProductAttributes","updateView","$scope","productId","purchasable","instock","checkBeforeAdd","slideUp","updateDefaultAttributesForOOS","show","totalPrice","$productOptionsElement","$changedOption","target","parents","undefined","FormData","productAttributesData","productAttributesContent","image","mainImageUrl","tools","getSrc","themeSettings","product_size","showProductImage","productOptionsChanged","productOptions","nextArrow","prevArrow","$attributes","check","focus","att","total","pos","symbol","i","currency","text","price","parseFloat","replace","s","toFixed","isNaN","behavior","out_of_stock_behavior","inStockIds","in_stock_attributes","outOfStockMessage","out_of_stock_message","attribute","$attribute","attrId","parseInt","getAttributeType","toggleOption","enableSelectOptionAttribute","enableAttribute","$select","selectedIndex","disableSelectOptionAttribute","hide","disableAttribute","$parent","closest","viewModel","$priceWithTax","$priceWithoutTax","rrpWithTax","$div","$span","rrpWithoutTax","nonSaleWithTax","nonSaleWithoutTax","priceSaved","priceNowLabel","priceLabel","$weight","$increments","$addToCart","$wishlistVariation","stock","$container","$sku","$upc","quantity","$text","$bulkPricing","getViewModel","clearPricingNotFound","with_tax","formatted","without_tax","rrp_with_tax","rrp_without_tax","saved","non_sale_price_with_tax","non_sale_price_without_tax","updatePriceView","template","num","relate_tab","getById","Number","getPage","remove","showFBT","next","slideDown","arrPro","Array","len","k","checkProduct","addToCart","arrP","cart","itemAdd","formData","key","File","size","delete","console","filterEmptyFilesFromForm","modal","onComplete","tmp","createElement","innerHTML","alert","textContent","innerText","open","cartItemId","params","suggest","config","suggestions","limit","getContent","getCartContent","cart_item","updateContent","$body","$cartQuantity","$cartCounter","swal"],"mappings":"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","file":"theme-bundle.chunk.4.js","sourcesContent":["/*\r\n Import all product specific js\r\n */\r\nimport PageManager from './page-manager';\r\nimport Review from './product/reviews';\r\nimport collapsibleFactory from './common/collapsible';\r\nimport ProductDetails from './common/product-details';\r\nimport videoGallery from './product/video-gallery';\r\nimport { classifyForm } from './common/form-utils';\r\nimport Countdown from './themevale/themevale_Countdown';\r\nimport stickyAddToCart from './themevale/themevale_stickyAddToCart';\r\nimport FBT from './themevale/themevale_fbt';\r\nimport compareProducts from './global/compare-products';\r\n\r\nexport default class Product extends PageManager {\r\n    constructor(context) {\r\n        super(context);\r\n        this.url = window.location.href;\r\n        this.$reviewLink = $('[data-reveal-id=\"modal-review-form\"]');\r\n    }\r\n\r\n    onReady() {\r\n        compareProducts(this.context.urls);\r\n        \r\n        // Listen for foundation modal close events to sanitize URL after review.\r\n        $(document).on('close.fndtn.reveal', () => {\r\n            if (this.url.indexOf('#write_review') !== -1 && typeof window.history.replaceState === 'function') {\r\n                window.history.replaceState(null, document.title, window.location.pathname);\r\n            }\r\n        });\r\n\r\n        let validator;\r\n\r\n        // Init collapsible\r\n        collapsibleFactory();\r\n\r\n        // countdown time\r\n        var product_id = $('[data-cart-item-add] [name=\"product_id\"]').val();\r\n        Countdown(product_id);\r\n\r\n        this.productDetails = new ProductDetails($('.productView'), this.context, window.BCData.product_attributes);\r\n        this.productDetails.setProductVariant();\r\n\r\n        videoGallery();\r\n\r\n        const $reviewForm = classifyForm('.writeReview-form');\r\n        const review = new Review($reviewForm);\r\n\r\n        $('body').on('click', '[data-reveal-id=\"modal-review-form\"]', () => {\r\n            validator = review.registerValidation(this.context);\r\n        });\r\n\r\n        $reviewForm.on('submit', () => {\r\n            if (validator) {\r\n                validator.performCheck();\r\n                return validator.areAll('valid');\r\n            }\r\n\r\n            return false;\r\n        });\r\n\r\n        this.productReviewHandler();\r\n        stickyAddToCart();\r\n        FBT(this.context);\r\n\r\n        if ($('.description-slider').length) {\r\n            this.descriptionSlider();\r\n            $('[data-collapsible]').on('click', function (event) {\r\n                $('.description-slider').slick('setPosition');\r\n            });\r\n        }\r\n\r\n        if ($('.description-slider-2').length) {\r\n            this.descriptionSlider2();\r\n            $('[data-collapsible]').on('click', function (event) {\r\n                $('.description-slider-2').slick('setPosition');\r\n            });\r\n        }\r\n    }\r\n\r\n    productReviewHandler() {\r\n        if (this.url.indexOf('#write_review') !== -1) {\r\n            this.$reviewLink.trigger('click');\r\n        }\r\n    }\r\n\r\n    descriptionSlider() {\r\n        $('.description-slider').slick({\r\n            dots: true,\r\n            arrows: false,\r\n            infinite: false,\r\n            slidesToShow: 2,\r\n            slidesToScroll: 2,\r\n            mobileFirst: true,\r\n            responsive: [\r\n            {\r\n                breakpoint: 551,\r\n                settings: {\r\n                    slidesToShow: 3,\r\n                    slidesToScroll: 3\r\n                }\r\n            }]\r\n        });\r\n    }\r\n\r\n    descriptionSlider2() {\r\n        $('.description-slider-2').slick({\r\n            dots: true,\r\n            arrows: false,\r\n            infinite: false,\r\n            slidesToShow: 2,\r\n            slidesToScroll: 2,\r\n            mobileFirst: true,\r\n            responsive: [\r\n            {\r\n                breakpoint: 750,\r\n                settings: {\r\n                    slidesToShow: 2,\r\n                    slidesToScroll: 2\r\n                }\r\n            },\r\n            {\r\n                breakpoint: 551,\r\n                settings: {\r\n                    slidesToShow: 3,\r\n                    slidesToScroll: 3\r\n                }\r\n            }]\r\n        });\r\n    }\r\n}\r\n","const forms = {\r\n    email(value) {\r\n        const re = /^.+@.+\\..+/;\r\n        return re.test(value);\r\n    },\r\n\r\n    /**\r\n     * Validates a password field\r\n     * @param value\r\n     * @returns {boolean}\r\n     */\r\n    password(value) {\r\n        return this.notEmpty(value);\r\n    },\r\n\r\n    /**\r\n     * validates if a field is empty\r\n     * @param value\r\n     * @returns {boolean}\r\n     *\r\n     */\r\n    notEmpty(value) {\r\n        return value.length > 0;\r\n    },\r\n};\r\n\r\nexport default forms;\r\n","import _ from 'lodash';\r\nimport nod from './nod';\r\nimport forms from './models/forms';\r\n\r\nconst inputTagNames = [\r\n    'input',\r\n    'select',\r\n    'textarea',\r\n];\r\n\r\n/**\r\n * Apply class name to an input element on its type\r\n * @param {object} input\r\n * @param {string} formFieldClass\r\n * @return {object} Element itself\r\n */\r\nfunction classifyInput(input, formFieldClass) {\r\n    const $input = $(input);\r\n    const $formField = $input.parent(`.${formFieldClass}`);\r\n    const tagName = $input.prop('tagName').toLowerCase();\r\n\r\n    let className = `${formFieldClass}--${tagName}`;\r\n    let specificClassName;\r\n\r\n    // Input can be text/checkbox/radio etc...\r\n    if (tagName === 'input') {\r\n        const inputType = $input.prop('type');\r\n\r\n        if (_.includes(['radio', 'checkbox', 'submit'], inputType)) {\r\n            // ie: .form-field--checkbox, .form-field--radio\r\n            className = `${formFieldClass}--${_.camelCase(inputType)}`;\r\n        } else {\r\n            // ie: .form-field--input .form-field--inputText\r\n            specificClassName = `${className}${_.capitalize(inputType)}`;\r\n        }\r\n    }\r\n\r\n    // Apply class modifier\r\n    return $formField\r\n        .addClass(className)\r\n        .addClass(specificClassName);\r\n}\r\n\r\n/**\r\n * Apply class name to each input element in a form based on its type\r\n * @example\r\n * // Before\r\n * <form id=\"form\">\r\n *     <div class=\"form-field\">\r\n *         <input type=\"text\">\r\n *     </div>\r\n *     <div class=\"form-field\">\r\n *         <select>...</select>\r\n *     </div>\r\n * </form>\r\n *\r\n * classifyForm('#form', { formFieldClass: 'form-field' });\r\n *\r\n * // After\r\n * <div class=\"form-field form-field--input form-field--inputText\">...</div>\r\n * <div class=\"form-field form-field--select\">...</div>\r\n *\r\n * @param {string|object} formSelector - selector or element\r\n * @param {object} options\r\n * @return {jQuery} Element itself\r\n */\r\nexport function classifyForm(formSelector, options = {}) {\r\n    const $form = $(formSelector);\r\n    const $inputs = $form.find(inputTagNames.join(', '));\r\n\r\n    // Obtain options\r\n    const { formFieldClass = 'form-field' } = options;\r\n\r\n    // Classify each input in a form\r\n    $inputs.each((__, input) => {\r\n        classifyInput(input, formFieldClass);\r\n    });\r\n\r\n    return $form;\r\n}\r\n\r\n/**\r\n * Get id from given field\r\n * @param {object} $field JQuery field object\r\n * @return {string}\r\n */\r\nfunction getFieldId($field) {\r\n    const fieldId = $field.prop('name').match(/(\\[.*\\])/);\r\n\r\n    if (fieldId && fieldId.length !== 0) {\r\n        return fieldId[0];\r\n    }\r\n\r\n    return '';\r\n}\r\n\r\n/**\r\n * Insert hidden field after State/Province field\r\n * @param {object} $stateField JQuery field object\r\n */\r\nfunction insertStateHiddenField($stateField) {\r\n    const fieldId = getFieldId($stateField);\r\n    const stateFieldAttrs = {\r\n        type: 'hidden',\r\n        name: `FormFieldIsText${fieldId}`,\r\n        value: '1',\r\n    };\r\n\r\n    $stateField.after($('<input />', stateFieldAttrs));\r\n}\r\n\r\nconst Validators = {\r\n    /**\r\n     * Sets up a new validation when the form is dirty\r\n     * @param validator\r\n     * @param field\r\n     */\r\n    setEmailValidation: (validator, field) => {\r\n        if (field) {\r\n            validator.add({\r\n                selector: field,\r\n                validate: (cb, val) => {\r\n                    const result = forms.email(val);\r\n\r\n                    cb(result);\r\n                },\r\n                errorMessage: 'You must enter a valid email.',\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Validate password fields\r\n     * @param validator\r\n     * @param passwordSelector\r\n     * @param password2Selector\r\n     * @param requirements\r\n     * @param isOptional\r\n     */\r\n    setPasswordValidation: (validator, passwordSelector, password2Selector, requirements, isOptional) => {\r\n        const $password = $(passwordSelector);\r\n        const passwordValidations = [\r\n            {\r\n                selector: passwordSelector,\r\n                validate: (cb, val) => {\r\n                    const result = val.length;\r\n\r\n                    if (isOptional) {\r\n                        return cb(true);\r\n                    }\r\n\r\n                    cb(result);\r\n                },\r\n                errorMessage: 'You must enter a password.',\r\n            },\r\n            {\r\n                selector: passwordSelector,\r\n                validate: (cb, val) => {\r\n                    const result = val.match(new RegExp(requirements.alpha))\r\n                        && val.match(new RegExp(requirements.numeric))\r\n                        && val.length >= requirements.minlength;\r\n\r\n                    // If optional and nothing entered, it is valid\r\n                    if (isOptional && val.length === 0) {\r\n                        return cb(true);\r\n                    }\r\n\r\n                    cb(result);\r\n                },\r\n                errorMessage: requirements.error,\r\n            },\r\n            {\r\n                selector: password2Selector,\r\n                validate: (cb, val) => {\r\n                    const result = val.length;\r\n\r\n                    if (isOptional) {\r\n                        return cb(true);\r\n                    }\r\n\r\n                    cb(result);\r\n                },\r\n                errorMessage: 'You must enter a password.',\r\n            },\r\n            {\r\n                selector: password2Selector,\r\n                validate: (cb, val) => {\r\n                    const result = val === $password.val();\r\n\r\n                    cb(result);\r\n                },\r\n                errorMessage: 'Your passwords do not match.',\r\n            },\r\n        ];\r\n\r\n        validator.add(passwordValidations);\r\n    },\r\n\r\n    /**\r\n     * Validate password fields\r\n     * @param {Nod} validator\r\n     * @param {Object} selectors\r\n     * @param {string} selectors.errorSelector\r\n     * @param {string} selectors.fieldsetSelector\r\n     * @param {string} selectors.formSelector\r\n     * @param {string} selectors.maxPriceSelector\r\n     * @param {string} selectors.minPriceSelector\r\n     */\r\n    setMinMaxPriceValidation: (validator, selectors) => {\r\n        const {\r\n            errorSelector,\r\n            fieldsetSelector,\r\n            formSelector,\r\n            maxPriceSelector,\r\n            minPriceSelector,\r\n        } = selectors;\r\n\r\n        validator.configure({\r\n            form: formSelector,\r\n            preventSubmit: true,\r\n            successClass: '_', // KLUDGE: Don't apply success class\r\n        });\r\n\r\n        validator.add({\r\n            errorMessage: 'Min price must be less than max. price.',\r\n            selector: minPriceSelector,\r\n            validate: `min-max:${minPriceSelector}:${maxPriceSelector}`,\r\n        });\r\n\r\n        validator.add({\r\n            errorMessage: 'Min price must be less than max. price.',\r\n            selector: maxPriceSelector,\r\n            validate: `min-max:${minPriceSelector}:${maxPriceSelector}`,\r\n        });\r\n\r\n        validator.add({\r\n            errorMessage: 'Max. price is required.',\r\n            selector: maxPriceSelector,\r\n            validate: 'presence',\r\n        });\r\n\r\n        validator.add({\r\n            errorMessage: 'Min. price is required.',\r\n            selector: minPriceSelector,\r\n            validate: 'presence',\r\n        });\r\n\r\n        validator.add({\r\n            errorMessage: 'Input must be greater than 0.',\r\n            selector: [minPriceSelector, maxPriceSelector],\r\n            validate: 'min-number:0',\r\n        });\r\n\r\n        validator.setMessageOptions({\r\n            selector: [minPriceSelector, maxPriceSelector],\r\n            parent: fieldsetSelector,\r\n            errorSpan: errorSelector,\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Sets up a new validation when the form is dirty\r\n     * @param validator\r\n     * @param field\r\n     */\r\n    setStateCountryValidation: (validator, field) => {\r\n        if (field) {\r\n            validator.add({\r\n                selector: field,\r\n                validate: 'presence',\r\n                errorMessage: 'The \\'State/Province\\' field cannot be blank.',\r\n            });\r\n        }\r\n    },\r\n\r\n    /**\r\n     * Removes classes from dirty form if previously checked\r\n     * @param field\r\n     */\r\n    cleanUpStateValidation: (field) => {\r\n        const $fieldClassElement = $((`[data-type=\"${field.data('fieldType')}\"]`));\r\n\r\n        Object.keys(nod.classes).forEach((value) => {\r\n            if ($fieldClassElement.hasClass(nod.classes[value])) {\r\n                $fieldClassElement.removeClass(nod.classes[value]);\r\n            }\r\n        });\r\n    },\r\n};\r\n\r\nexport { Validators, insertStateHiddenField };\r\n","import _ from 'lodash';\r\nimport { showAlertModal } from './modal';\r\n\r\nfunction decrementCounter(counter, item) {\r\n    const index = counter.indexOf(item);\r\n\r\n    if (index > -1) {\r\n        counter.splice(index, 1);\r\n    }\r\n}\r\n\r\nfunction incrementCounter(counter, item) {\r\n    counter.push(item);\r\n}\r\n\r\nfunction updateCounterNav(counter, $link, urlContext) {\r\n    if (counter.length !== 0) {\r\n        if (!$link.is('visible')) {\r\n            $link.addClass('show');\r\n        }\r\n        $link.attr('href', `${urlContext.compare}/${counter.join('/')}`);\r\n        $link.find('span.countPill').html(counter.length);\r\n    } else {\r\n        $link.removeClass('show');\r\n    }\r\n}\r\n\r\nexport default function (urlContext) {\r\n    let products;\r\n\r\n    const $checked = $('body').find('input[name=\"products\\[\\]\"]:checked');\r\n    const $compareLink = $('a[data-compare-nav]');\r\n\r\n    if ($checked.length !== 0) {\r\n        products = _.map($checked, element => element.value);\r\n\r\n        updateCounterNav(products, $compareLink, urlContext);\r\n    }\r\n\r\n    const compareCounter = products || [];\r\n\r\n    $('body').on('click', '[data-compare-id]', event => {\r\n        const product = event.currentTarget.value;\r\n        const $clickedCompareLink = $('a[data-compare-nav]');\r\n\r\n        if (event.currentTarget.checked) {\r\n            incrementCounter(compareCounter, product);\r\n        } else {\r\n            decrementCounter(compareCounter, product);\r\n        }\r\n\r\n        updateCounterNav(compareCounter, $clickedCompareLink, urlContext);\r\n    });\r\n\r\n    $('body').on('submit', '[data-product-compare]', event => {\r\n        const $this = $(event.currentTarget);\r\n        const productsToCompare = $this.find('input[name=\"products\\[\\]\"]:checked');\r\n\r\n        if (productsToCompare.length <= 1) {\r\n            showAlertModal('You must select at least two products to compare');\r\n            event.preventDefault();\r\n        }\r\n    });\r\n\r\n    $('body').on('click', 'a[data-compare-nav]', () => {\r\n        const $clickedCheckedInput = $('body').find('input[name=\"products\\[\\]\"]:checked');\r\n\r\n        if ($clickedCheckedInput.length <= 1) {\r\n            showAlertModal('You must select at least two products to compare');\r\n            return false;\r\n        }\r\n    });\r\n}\r\n","import nod from '../common/nod';\r\nimport { CollapsibleEvents } from '../common/collapsible';\r\nimport forms from '../common/models/forms';\r\n\r\nexport default class {\r\n    constructor($reviewForm) {\r\n        this.validator = nod({\r\n            submit: $reviewForm.find('input[type=\"submit\"]'),\r\n        });\r\n\r\n        this.$reviewsContent = $('#product-reviews');\r\n        this.$collapsible = $('[data-collapsible]', this.$reviewsContent);\r\n        this.$collapsible2 = $('.productView-reviewTabLink');\r\n\r\n        this.initLinkBind();\r\n        this.injectPaginationLink();\r\n        this.collapseReviews();\r\n    }\r\n\r\n    /**\r\n     * On initial page load, the user clicks on \"(12 Reviews)\" link\r\n     * The browser jumps to the review page and should expand the reviews section\r\n     */\r\n    initLinkBind() {\r\n       const $content = $('#productReviews-content', this.$reviewsContent);\r\n       const $content2 = $('#product-reviews');\r\n        $('.review-link a').on('click', (e) => {\r\n            e.preventDefault();\r\n            $('.is-open[data-collapsible]', $('.tabs-vertical')).trigger(CollapsibleEvents.click);\r\n\r\n            if($('.themevale_productDescription-3').length) {\r\n                $('.is-open[data-collapsible]', $('.themevale_productDescription-3')).trigger(CollapsibleEvents.click);\r\n                if ($(window).width() > 1024) {\r\n                    $('html, body').animate({\r\n                        scrollTop: $('#tab-review').offset().top - $('.header').height(),\r\n                    }, 700);\r\n                } else {\r\n                    $('html, body').animate({\r\n                        scrollTop: this.$reviewsContent.offset().top - $('.header').height(),\r\n                    }, 700);\r\n                }\r\n            } else {\r\n                $('html, body').animate({\r\n                    scrollTop: this.$reviewsContent.offset().top - $('.header').height(),\r\n                }, 700);\r\n            }\r\n            \r\n            if (!$content.hasClass('is-open')) {\r\n                this.$collapsible.trigger(CollapsibleEvents.click);\r\n            }\r\n\r\n            if($('.themevale_productDescription-3').length) {\r\n                if (!$content2.hasClass('is-active')) {\r\n                    this.$collapsible2.trigger('click');\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    collapseReviews() {\r\n        // We're in paginating state, do not collapse\r\n        if (window.location.hash && window.location.hash.indexOf('#product-reviews') === 0) {\r\n            return;\r\n        }\r\n\r\n        // force collapse on page load\r\n        // this.$collapsible2.trigger(CollapsibleEvents.click);\r\n    }\r\n\r\n    /**\r\n     * Inject ID into the pagination link\r\n     */\r\n    injectPaginationLink() {\r\n        const $nextLink = $('.pagination-item--next .pagination-link', this.$reviewsContent);\r\n        const $prevLink = $('.pagination-item--previous .pagination-link', this.$reviewsContent);\r\n\r\n        if ($nextLink.length) {\r\n            $nextLink.attr('href', `${$nextLink.attr('href')} #product-reviews`);\r\n        }\r\n\r\n        if ($prevLink.length) {\r\n            $prevLink.attr('href', `${$prevLink.attr('href')} #product-reviews`);\r\n        }\r\n    }\r\n\r\n    registerValidation(context) {\r\n        this.context = context;\r\n        this.validator.add([{\r\n            selector: '[name=\"revrating\"]',\r\n            validate: 'presence',\r\n            errorMessage: this.context.reviewRating,\r\n        }, {\r\n            selector: '[name=\"revtitle\"]',\r\n            validate: 'presence',\r\n            errorMessage: this.context.reviewSubject,\r\n        }, {\r\n            selector: '[name=\"revtext\"]',\r\n            validate: 'presence',\r\n            errorMessage: this.context.reviewComment,\r\n        }, {\r\n            selector: '[name=\"email\"]',\r\n            validate: (cb, val) => {\r\n                const result = forms.email(val);\r\n                cb(result);\r\n            },\r\n            errorMessage: this.context.reviewEmail,\r\n        }]);\r\n\r\n        return this.validator;\r\n    }\r\n\r\n    validate() {\r\n        return this.validator.performCheck();\r\n    }\r\n}\r\n","export class VideoGallery {\r\n    constructor($element) {\r\n        this.$player = $element.find('[data-video-player]');\r\n        this.$videos = $element.find('[data-video-item]');\r\n        this.currentVideo = {};\r\n        this.bindEvents();\r\n    }\r\n\r\n    selectNewVideo(e) {\r\n        e.preventDefault();\r\n\r\n        const $target = $(e.currentTarget);\r\n\r\n        this.currentVideo = {\r\n            id: $target.data('videoId'),\r\n            $selectedThumb: $target,\r\n        };\r\n\r\n        this.setMainVideo();\r\n        this.setActiveThumb();\r\n    }\r\n\r\n    setMainVideo() {\r\n        this.$player.attr('src', `//www.youtube.com/embed/${this.currentVideo.id}`);\r\n    }\r\n\r\n    setActiveThumb() {\r\n        this.$videos.removeClass('is-active');\r\n        this.currentVideo.$selectedThumb.addClass('is-active');\r\n    }\r\n\r\n    bindEvents() {\r\n        this.$videos.on('click', this.selectNewVideo.bind(this));\r\n    }\r\n}\r\n\r\nexport default function videoGallery() {\r\n    const pluginKey = 'video-gallery';\r\n    const $videoGallery = $(`[data-${pluginKey}]`);\r\n\r\n    $videoGallery.each((index, element) => {\r\n        const $el = $(element);\r\n        const isInitialized = $el.data(pluginKey) instanceof VideoGallery;\r\n\r\n        if (isInitialized) {\r\n            return;\r\n        }\r\n\r\n        $el.data(pluginKey, new VideoGallery($el));\r\n    });\r\n}\r\n","import $ from 'jquery';\r\nimport utils from '@bigcommerce/stencil-utils';\r\nimport swal from 'sweetalert2';\r\nimport _ from 'lodash';\r\n\r\nexport default function(){\r\n    var scroll = $('#form-action-addToCart').offset();\r\n\r\n    $(window).scroll(function(){\r\n        if($(window).scrollTop() > scroll.top + 100){\r\n            if(!$('#sticky_addtocart').hasClass('show_sticky')){\r\n                $('#sticky_addtocart').addClass('show_sticky');\r\n                if ($(window).width() > 1024) {\r\n                    $('.themevale_popup_left').css(\"bottom\", $('#sticky_addtocart').outerHeight() + 40);\r\n                    $('.themevale_popup_right').css(\"bottom\", $('#sticky_addtocart').outerHeight() + 40);\r\n                } else if ($(window).width() > 550) {\r\n                    $('.themevale_popup_left').css(\"bottom\", $('.themevale_popup_right').outerHeight() + $('#sticky_addtocart').outerHeight() + 30);\r\n                    $('.themevale_popup_right').css(\"bottom\", $('#sticky_addtocart').outerHeight() + 15 );\r\n                } else {\r\n                    $('.themevale_popup_left').css(\"bottom\", $('.themevale_popup_right').outerHeight() + $('#sticky_addtocart').outerHeight());\r\n                    $('.themevale_popup_right').css(\"bottom\", $('#sticky_addtocart').outerHeight());\r\n                }\r\n            }\r\n        } else{\r\n            $('#sticky_addtocart').removeClass('show_sticky');\r\n            $('.pop-up-option').removeClass('is-open');\r\n            $('.choose_options_add').removeClass('is-active');\r\n            if ($(window).width() > 1024) {\r\n                $('.themevale_popup_left').css(\"bottom\", 40);\r\n                $('.themevale_popup_right').css(\"bottom\", 40);\r\n            } else if ($(window).width() > 550) {\r\n                $('.themevale_popup_left').css(\"bottom\", $('.themevale_popup_right').outerHeight() + 30);\r\n                $('.themevale_popup_right').css(\"bottom\", 15);\r\n            } else {\r\n                $('.themevale_popup_left').css(\"bottom\", $('.themevale_popup_right').outerHeight());\r\n                $('.themevale_popup_right').css(\"bottom\", 0);\r\n            }\r\n        }\r\n    });\r\n\r\n    $(document).on('click','.choose_options_add', function(event){\r\n        $(this).toggleClass('is-active');\r\n        $('.pop-up-option').toggleClass('is-open');\r\n    });\r\n\r\n    $(document).on('click','.pop-up-option .close', function(event){\r\n        $(\".pop-up-option\").removeClass('is-open');\r\n        $('.choose_options_add').removeClass('is-active');\r\n    });\r\n\r\n    window.onload = function(){\r\n        if($(window).scrollTop() > scroll.top - 160){\r\n            if(!$('#sticky_addtocart').hasClass('show_sticky')){\r\n                $('#sticky_addtocart').addClass('show_sticky');\r\n                if ($(window).width() > 1024) {\r\n                    $('.themevale_popup_left').css(\"bottom\", $('#sticky_addtocart').outerHeight() + 40);\r\n                    $('.themevale_popup_right').css(\"bottom\", $('#sticky_addtocart').outerHeight() + 40);\r\n                } else if ($(window).width() > 550) {\r\n                    $('.themevale_popup_left').css(\"bottom\", $('.themevale_popup_right').outerHeight() + $('#sticky_addtocart').outerHeight() + 30);\r\n                    $('.themevale_popup_right').css(\"bottom\", $('#sticky_addtocart').outerHeight() + 15 );\r\n                } else {\r\n                    $('.themevale_popup_left').css(\"bottom\", $('.themevale_popup_right').outerHeight() + $('#sticky_addtocart').outerHeight());\r\n                    $('.themevale_popup_right').css(\"bottom\", $('#sticky_addtocart').outerHeight());\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n","import $ from 'jquery';\r\nimport utils from '@bigcommerce/stencil-utils';\r\nimport swal from 'sweetalert2';\r\nimport _ from 'lodash';\r\nimport modalFactory, { showAlertModal } from '../global/modal';\r\n\r\nexport default function(context) {\r\n    const relate_tab = \"#product-related\";\r\n    const previewModal = modalFactory('#previewModal')[0];\r\n\r\n    // check custom field fbt\r\n    showFBT();\r\n\r\n    $(document).on('click', '.themvale-fbt-toggle-options', function() {\r\n        if ($(this).next().is(':visible') == false) {\r\n            $(this).next().slideDown();\r\n        } else {\r\n            $(this).next().slideUp();\r\n        }\r\n    });\r\n\r\n    $(document).on('change', '.themvale-fbt-detail-checkbox', function() {\r\n        var id = $(this).attr('id').replace('fbt_product', '');\r\n        if ($(this).is(':checked') == false) {\r\n            $('.themvale-fbt-product-item[data-product-id=\"' + id + '\"]').removeClass('isChecked');\r\n            $(this).parents('form').find('.themvale-fbt-detail-options').slideUp();\r\n        } else {\r\n            $('.themvale-fbt-product-item[data-product-id=\"' + id + '\"]').addClass('isChecked');\r\n        }\r\n        totalPrice();\r\n    });\r\n\r\n    $(document).on('click', '#themvale-fbt-addAll', function(event) {\r\n        const $form = $('form', $('#themvale-fbt'));\r\n        var arrPro = new Array();\r\n        $('.themvale-fbt-detail-checkbox').each(function(i, val) {\r\n            if ($(val).is(':checked')) {\r\n                arrPro.push(i);\r\n            }\r\n        });\r\n\r\n        var check = false;\r\n\r\n        if (arrPro.length > 0) {\r\n            check = checkProduct($form, arrPro);\r\n        }\r\n\r\n        if (check) {\r\n            if (arrPro.length > 0) {\r\n                $('#themvale-fbt .loadingOverlay').show();\r\n                addToCart($form, 0, arrPro);\r\n            }\r\n        } else {\r\n            swal({\r\n                text: 'Please make sure all options have been filled in.',\r\n                type: 'warning',\r\n            });\r\n        }\r\n\r\n        event.preventDefault();\r\n    });\r\n\r\n    function showFBT() {\r\n        // related product\r\n        const options = {\r\n                template: {\r\n                    item: 'themevale/fbt-item',\r\n                    options: 'themevale/fbt-options',\r\n                },\r\n            };\r\n\r\n        if ($('.productView-info-name.fbt').length > 0) {\r\n            var num = 0;\r\n            var list = [];\r\n\r\n            $(relate_tab + ' .card').each(function(i, val) {\r\n                list.push( {i:i, data: \"\"} );\r\n                var pId = $(val).data('product-id');\r\n                if (pId != undefined) {\r\n                    utils.api.product.getById(pId, options, (err, response) => {\r\n                        if (err) {\r\n                            return '';\r\n                        }\r\n                        list.forEach(function(element) {\r\n                            if(element.i == i){\r\n                                element.data = response;\r\n                            }\r\n                        });\r\n                        \r\n                        num++;\r\n                        if(num == $(relate_tab + ' .card').length)\r\n                            showList(list);\r\n                    });\r\n                }\r\n\r\n            });\r\n        } else if ($('.productView-info-name.fbt-product').length > 0) {\r\n            var num = 0;\r\n            var list = [];\r\n\r\n            $('.productView-info-value.fbt-product').each(function(i) {\r\n                list.push( {i:i, data: \"\"} );\r\n                if (!isNaN(Number($(this).text()))) {\r\n                    var productId = Number($(this).text())\r\n                    utils.api.product.getById(productId, options, (err, response) => {\r\n                        if (err) {\r\n                            return '';\r\n                        }\r\n                        list.forEach(function(element) {\r\n                            if(element.i == i){\r\n                                element.data = response;\r\n                            }\r\n                        });\r\n                        num++;\r\n                        if(num == $('.productView-info-value.fbt-product').length)\r\n                            showList(list);\r\n                    });\r\n                } else {\r\n                    utils.api.getPage($(this).text(), options, (err, response) => {\r\n                        if (err) {\r\n                            return '';\r\n                        }\r\n                        list.forEach(function(element) {\r\n                            if(element.i == i){\r\n                                element.data = response;\r\n                            }\r\n                        });\r\n                        num++;\r\n                        if(num == $('.productView-info-value.fbt-product').length)\r\n                            showList(list);\r\n                    });\r\n                }\r\n            });\r\n        } else {\r\n            $('#themvale-fbt').remove();\r\n        }\r\n    }\r\n\r\n    function showList(list){\r\n        list.forEach(function(element) {\r\n            var response = element.data;\r\n            $('#themvale-fbt .themvale-fbt-product-list').append(response.item);\r\n            if (response.options.trim() != \"\") {\r\n                var pId = $(response.item).data('product-id');\r\n                const $form = $('#themvale-fbt .themvale-fbt-product-list .themvale-fbt-product-item[data-product-id=\"' + pId + '\"] form');\r\n                $form.append(response.options);\r\n                const $productOptionsElement = $('[data-fbt-option-change]', $form);\r\n                const hasOptions = $productOptionsElement.html().trim().length;\r\n                const hasDefaultOptions = $(response.options).find('[data-default]').length;\r\n                if ( hasDefaultOptions && hasOptions) {\r\n                    utils.api.productAttributes.optionChange(pId, $form.serialize(), 'products/bulk-discount-rates', (err, response) => {\r\n                        const attributesData = response.data || {};\r\n                        const attributesContent = response.content || {};\r\n                        updateProductAttributes($form, attributesData);\r\n                        if (hasDefaultOptions) {\r\n                            updateView($form, attributesData, attributesContent);\r\n                        } else {\r\n                            updateDefaultAttributesForOOS(attributesData);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n        $('#themvale-fbt').show();\r\n        productOptions();\r\n        $('#themvale-fbt .themvale-fbt-product-wrapper').append('<div class=\"themvale-fbt-total fbt__total\">\\\r\n          <p class=\"themevale-text-price\"><span>Total:</span> <span class=\"themvale-fbt-total-price\" id=\"themvale-fbt-totalPrice\"></span></p>\\\r\n          <a class=\"button button--primary themvale-fbt-total-button\" id=\"themvale-fbt-addAll\" href=\"#\">Add all to Cart</a>\\\r\n        </div>');\r\n        slick_slider();\r\n        totalPrice();\r\n    }\r\n\r\n    function slick_slider() {\r\n        if ($('.product-layout-3').length) {\r\n            $('.themvale-fbt-product-list').slick({\r\n                dots: true,\r\n                arrows: false,\r\n                slidesToShow: 2,\r\n                slidesToScroll: 2,\r\n                mobileFirst: true,\r\n                infinite: false,\r\n                nextArrow: \"<svg class='slick-next slick-arrow'><use xlink:href='#icon-slick-next'></use></svg>\",\r\n                prevArrow: \"<svg class='slick-prev slick-arrow'><use xlink:href='#icon-slick-prev'></use></svg>\",\r\n                responsive: [\r\n                    {\r\n                        breakpoint: 1025,\r\n                        settings: {\r\n                            slidesToScroll: 3,\r\n                            slidesToShow: 3,\r\n                            dots: false,\r\n                            arrows: true\r\n                        }\r\n                    },\r\n                    {\r\n                        breakpoint: 992,\r\n                        settings: {\r\n                            slidesToScroll: 4,\r\n                            slidesToShow: 4\r\n                        }\r\n                    },\r\n                    {\r\n                        breakpoint: 551,\r\n                        settings: {\r\n                            slidesToScroll: 3,\r\n                            slidesToShow: 3\r\n                        }\r\n                    }\r\n                ]\r\n            });\r\n        } else {\r\n            $('.themvale-fbt-product-list').slick({\r\n                dots: true,\r\n                arrows: false,\r\n                slidesToShow: 2,\r\n                slidesToScroll: 2,\r\n                mobileFirst: true,\r\n                infinite: false,\r\n                nextArrow: \"<svg class='slick-next slick-arrow'><use xlink:href='#icon-slick-next'></use></svg>\",\r\n                prevArrow: \"<svg class='slick-prev slick-arrow'><use xlink:href='#icon-slick-prev'></use></svg>\",\r\n                responsive: [\r\n                    {\r\n                        breakpoint: 1025,\r\n                        settings: {\r\n                            slidesToScroll: 4,\r\n                            slidesToShow: 4,\r\n                            dots: false,\r\n                            arrows: true\r\n                        }\r\n                    },\r\n                    {\r\n                        breakpoint: 992,\r\n                        settings: {\r\n                            slidesToScroll: 4,\r\n                            slidesToShow: 4\r\n                        }\r\n                    },\r\n                    {\r\n                        breakpoint: 551,\r\n                        settings: {\r\n                            slidesToScroll: 3,\r\n                            slidesToShow: 3\r\n                        }\r\n                    }\r\n                ]\r\n            });\r\n            \r\n        }\r\n    }\r\n\r\n    function checkProduct(form, arrPro) {\r\n        var check = true;\r\n\r\n        for (var i = 0, len = arrPro.length; i < len; i++) {\r\n            var k = arrPro[i];\r\n            var $form = $(form[k]);\r\n            if ($form.find('[data-fbt-option-change]').length) {\r\n                check = checkBeforeAdd($form);\r\n                if (check == false)\r\n                    return false;\r\n            }\r\n        }\r\n        return check;\r\n    }\r\n\r\n    function checkBeforeAdd($attributes) {\r\n        var check = true;\r\n        $attributes.find('input:text, input:password, input:file, textarea').each(function() {\r\n\r\n            if (!$(this).prop('required')) {} else {\r\n                if ($(this).val()) {} else {\r\n                    $(this).focus();\r\n                    check = false;\r\n                }\r\n            }\r\n        });\r\n\r\n        $attributes.find('select').each(function() {\r\n\r\n            if (!$(this).prop('required')) {\r\n\r\n            } else {\r\n                if ($(this).val()) {} else {\r\n                    $(this).focus();\r\n                    check = false;\r\n                }\r\n            }\r\n        });\r\n\r\n        var att = \"\";\r\n        $attributes.find('input:radio, input:checkbox').each(function() {\r\n            if (att != $(this).attr(\"name\")) {\r\n\r\n                att = $(this).attr(\"name\");\r\n                if (!$(this).prop('required')) {\r\n                    if ($(this).attr(\"type\") == \"checkbox\") {\r\n                        if ($(\"[name='\" + att + \"']:checked\").val()) {}\r\n                    }\r\n                    if ($(this).attr(\"type\") == \"radio\") {\r\n                        if ($(\"[name='\" + att + \"']:checked\").val()) {}\r\n                    }\r\n                } else {\r\n                    if ($(this).attr(\"type\") == \"checkbox\") {\r\n                        if ($(\"[name='\" + att + \"']:checked\").val()) {} else {\r\n                            check = false;\r\n                        }\r\n                    }\r\n                    if ($(this).attr(\"type\") == \"radio\") {\r\n                        if ($(\"[name='\" + att + \"']:checked\").val()) {} else {\r\n                            check = false;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        return check;\r\n    }\r\n\r\n    function addToCart(form, i, arrP) {\r\n\r\n        if (i >= arrP.length) {\r\n            window.location = '/cart.php';\r\n            return;\r\n        }\r\n\r\n        if (window.FormData === undefined) {\r\n            return;\r\n        }\r\n        var k = arrP[i];\r\n        // Add item to cart\r\n        utils.api.cart.itemAdd(filterEmptyFilesFromForm(new FormData(form[k])), (err, response) => {\r\n            const errorMessage = err || response.data.error;\r\n\r\n            // Guard statement\r\n            if (errorMessage) {\r\n                // Strip the HTML from the error message\r\n                const tmp = document.createElement('DIV');\r\n                tmp.innerHTML = errorMessage;\r\n                alert(tmp.textContent || tmp.innerText);\r\n            }\r\n            i++;\r\n            if (i >= arrP.length) {\r\n                // window.location = '/cart.php';\r\n                if (previewModal) {\r\n                    previewModal.open();    \r\n                    $('#themvale-fbt .loadingOverlay').hide();\r\n                    updateCartContent(previewModal, response.data.cart_item.id);\r\n                } else {\r\n                    // if no modal, redirect to the cart page\r\n                    window.location = '/cart.php';\r\n                }\r\n                return;\r\n            }\r\n            addToCart(form, i, arrP);\r\n            // return response.data.cart_item.product_id;\r\n        });\r\n    }\r\n    function updateCartContent(modal, cartItemId, onComplete) {\r\n        getCartContent(cartItemId, (err, response) => {\r\n            if (err) {\r\n                return;\r\n            }\r\n\r\n            modal.updateContent(response);\r\n\r\n            // Update cart counter\r\n            const $body = $('body');\r\n            const $cartQuantity = $('[data-cart-quantity]', modal.$content);\r\n            const $cartCounter = $('.navUser-action .cart-count');\r\n            const quantity = $cartQuantity.data('cartQuantity') || 0;\r\n\r\n            $cartCounter.addClass('cart-count--positive');\r\n            $body.trigger('cart-quantity-update', quantity);\r\n\r\n            if (onComplete) {\r\n                onComplete(response);\r\n            }\r\n        });\r\n    }\r\n\r\n    function getCartContent(cartItemId, onComplete) {\r\n        const options = {\r\n            template: 'cart/preview',\r\n            params: {\r\n                suggest: cartItemId,\r\n            },\r\n            config: {\r\n                cart: {\r\n                    suggestions: {\r\n                        limit: 4,\r\n                    },\r\n                },\r\n            },\r\n        };\r\n\r\n        utils.api.cart.getContent(options, onComplete);\r\n    }\r\n\r\n    function totalPrice() {\r\n        var total = 0;\r\n        var pos = 0;\r\n        var symbol = \"$\";\r\n        $('.themvale-fbt-product-item.isChecked').each(function(i, val) {\r\n            if ($(val).find('.price-section .price.price--withTax').length)\r\n                var currency = $(val).find('.price-section .price.price--withTax').text();\r\n            else\r\n                var currency = $(val).find('.price-section .price.price--withoutTax').text();\r\n            var price = parseFloat(currency.replace(/[^0-9.-]+/g, \"\"));\r\n            var s = currency.replace(parseFloat(price).toFixed(2).replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\"), \"\");\r\n            if (isNaN(parseFloat(s.replace(/[^0-9.-]+/g, \"\"))))\r\n                symbol = s;\r\n            if (currency.indexOf(symbol) != -1)\r\n                pos = currency.indexOf(symbol);\r\n            total = total + price;\r\n        });\r\n        total = parseFloat(total).toFixed(2).replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n        if (pos == 0)\r\n            total = symbol + total;\r\n        else\r\n            total = total + symbol;\r\n        $('#themvale-fbt-totalPrice').html(total);\r\n    }\r\n\r\n    function productOptions() {\r\n        totalPrice();\r\n        const $form = $('form', $(document));\r\n\r\n        // var arrPro = new Array();\r\n        // for (var i = 0, len = $form.length; i < len; i++) {\r\n            const $productOptionsElement = $('[data-fbt-option-change]', $form);\r\n            $(document).on('change', $productOptionsElement, event => {\r\n                productOptionsChanged(event);\r\n            });\r\n        // }\r\n\r\n        $(document).on('click', '.close-options', function() {\r\n            $(this).parent().slideUp();\r\n        });\r\n    }\r\n\r\n    function productOptionsChanged(event) {\r\n        const $changedOption = $(event.target);\r\n        const $form = $changedOption.parents('form');\r\n        const productId = $('[name=\"product_id\"]', $form).val();\r\n        // Do not trigger an ajax request if it's a file or if the browser doesn't support FormData\r\n        if ($changedOption.attr('type') === 'file' || window.FormData === undefined) {\r\n            return;\r\n        }\r\n        if ($changedOption.attr('id') === 'fbt_product' + productId) {\r\n            return;\r\n        }\r\n        \r\n        utils.api.productAttributes.optionChange(productId, $form.serialize(), 'products/bulk-discount-rates', (err, response) => {\r\n            const productAttributesData = response.data || {};\r\n            const productAttributesContent = response.content || {};\r\n            showProductImage(productId, productAttributesData);\r\n            updateProductAttributes($form, productAttributesData);\r\n            updateView($form, productAttributesData, productAttributesContent);\r\n            totalPrice();\r\n        });\r\n        return false;\r\n    }\r\n    \r\n    function updateProductAttributes($scope, data) {\r\n        const behavior = data.out_of_stock_behavior;\r\n        const inStockIds = data.in_stock_attributes;\r\n        const outOfStockMessage = ` (${data.out_of_stock_message})`;\r\n\r\n        if (behavior !== 'hide_option' && behavior !== 'label_option') {\r\n            return;\r\n        }\r\n\r\n        $('[data-product-attribute-value]', $scope).each((i, attribute) => {\r\n            const $attribute = $(attribute);\r\n            const attrId = parseInt($attribute.data('productAttributeValue'), 10);\r\n\r\n\r\n            if (inStockIds.indexOf(attrId) !== -1) {\r\n                enableAttribute($attribute, behavior, outOfStockMessage);\r\n            } else {\r\n                disableAttribute($attribute, behavior, outOfStockMessage);\r\n            }\r\n        });\r\n    }\r\n\r\n    function disableAttribute($attribute, behavior, outOfStockMessage) {\r\n        if (getAttributeType($attribute) === 'set-select') {\r\n            return disableSelectOptionAttribute($attribute, behavior, outOfStockMessage);\r\n        }\r\n\r\n        if (behavior === 'hide_option') {\r\n            $attribute.hide();\r\n        } else {\r\n            $attribute.addClass('unavailable');\r\n        }\r\n    }\r\n\r\n    function disableSelectOptionAttribute($attribute, behavior, outOfStockMessage) {\r\n        const $select = $attribute.parent();\r\n\r\n        if (behavior === 'hide_option') {\r\n            $attribute.toggleOption(false);\r\n            // If the attribute is the selected option in a select dropdown, select the first option (MERC-639)\r\n            if ($select.val() === $attribute.attr('value')) {\r\n                $select[0].selectedIndex = 0;\r\n            }\r\n        } else {\r\n            $attribute.attr('disabled', 'disabled');\r\n            $attribute.html($attribute.html().replace(outOfStockMessage, '') + outOfStockMessage);\r\n        }\r\n    }\r\n\r\n    function enableAttribute($attribute, behavior, outOfStockMessage) {\r\n        if (getAttributeType($attribute) === 'set-select') {\r\n            return enableSelectOptionAttribute($attribute, behavior, outOfStockMessage);\r\n        }\r\n\r\n        if (behavior === 'hide_option') {\r\n            $attribute.show();\r\n        } else {\r\n            $attribute.removeClass('unavailable');\r\n        }\r\n    }\r\n\r\n    function enableSelectOptionAttribute($attribute, behavior, outOfStockMessage) {\r\n        if (behavior === 'hide_option') {\r\n            $attribute.toggleOption(true);\r\n        } else {\r\n            $attribute.prop('disabled', false);\r\n            $attribute.html($attribute.html().replace(outOfStockMessage, ''));\r\n        }\r\n    }\r\n\r\n    function getAttributeType($attribute) {\r\n        const $parent = $attribute.closest('[data-product-attribute]');\r\n\r\n        return $parent ? $parent.data('productAttribute') : null;\r\n    }\r\n\r\n    function showProductImage(productId, data) {\r\n        if (_.isPlainObject(data.image)) {\r\n\r\n            const mainImageUrl = utils.tools.image.getSrc(\r\n                data.image.data,\r\n                context.themeSettings.product_size,\r\n            );\r\n\r\n            $('.themvale-fbt-product-item[data-product-id=\"' + productId + '\"]').find('img').attr({\r\n                'src': mainImageUrl,\r\n                'data-src': $(this).attr('src'),\r\n            });\r\n\r\n        } else {\r\n            const mainImageUrl = $('.themvale-fbt-product-item[data-product-id=\"' + productId + '\"]').find('img').attr('data-src');\r\n            $('.themvale-fbt-product-item[data-product-id=\"' + productId + '\"]').find('img').attr({\r\n                'src': mainImageUrl,\r\n                'data-src': $(this).attr('src'),\r\n            });\r\n        }\r\n    }\r\n\r\n    function updateView($scope, data, content = null) {\r\n        const viewModel = getViewModel($scope);\r\n\r\n        if (_.isObject(data.price)) {\r\n            updatePriceView(viewModel, data.price);\r\n        }\r\n        var productId = $('[name=\"product_id\"]', $scope).val();\r\n\r\n        if (!data.purchasable || !data.instock) {\r\n            $('.themvale-fbt-product-item[data-product-id=\"' + productId + '\"]').removeClass('isChecked');\r\n            $('#fbt_product' + productId).prop('checked', false).prop('disabled', true);\r\n            $('.themvale-fbt-product-item[data-product-id=\"' + productId + '\"]').removeClass('hasOptions--selected');\r\n        } else {\r\n            $('.themvale-fbt-product-item[data-product-id=\"' + productId + '\"]').addClass('isChecked');\r\n            $('#fbt_product' + productId).prop('checked', true).prop('disabled', false);\r\n\r\n            if ($scope.find('[data-fbt-option-change]').length) {\r\n                var check = checkBeforeAdd($scope);\r\n                if (check == true) {\r\n                    $('.themvale-fbt-product-item[data-product-id=\"' + productId + '\"]').addClass('hasOptions--selected');\r\n                    $('[data-fbt-option-change]', $scope).slideUp();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function updateDefaultAttributesForOOS($scope, data) {\r\n        var productId = $('[name=\"product_id\"]', $scope).val();\r\n\r\n        if (!data.purchasable || !data.instock) {\r\n            $('.themvale-fbt-product-item[data-product-id=\"' + productId + '\"]').removeClass('isChecked');\r\n            $('#fbt_product' + productId).prop('checked', false).prop('disabled', true);\r\n            $('.themvale-fbt-product-item[data-product-id=\"' + productId + '\"]').removeClass('hasOptions--selected');\r\n        } else {\r\n            $('.themvale-fbt-product-item[data-product-id=\"' + productId + '\"]').addClass('isChecked');\r\n            $('#fbt_product' + productId).prop('checked', true).prop('disabled', false);\r\n\r\n            if ($scope.find('[data-fbt-option-change]').length) {\r\n                var check = checkBeforeAdd($scope);\r\n                if (check == true) {\r\n                    $('.themvale-fbt-product-item[data-product-id=\"' + productId + '\"]').addClass('hasOptions--selected');\r\n                    $('[data-fbt-option-change]', $scope).slideUp();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function getViewModel($scope) {\r\n        return {\r\n            $priceWithTax: $('[data-product-price-with-tax]', $scope),\r\n            $priceWithoutTax: $('[data-product-price-without-tax]', $scope),\r\n            rrpWithTax: {\r\n                $div: $('.rrp-price--withTax', $scope),\r\n                $span: $('[data-product-rrp-with-tax]', $scope),\r\n            },\r\n            rrpWithoutTax: {\r\n                $div: $('.rrp-price--withoutTax', $scope),\r\n                $span: $('[data-product-rrp-price-without-tax]', $scope),\r\n            },\r\n            nonSaleWithTax: {\r\n                $div: $('.non-sale-price--withTax', $scope),\r\n                $span: $('[data-product-non-sale-price-with-tax]', $scope),\r\n            },\r\n            nonSaleWithoutTax: {\r\n                $div: $('.non-sale-price--withoutTax', $scope),\r\n                $span: $('[data-product-non-sale-price-without-tax]', $scope),\r\n            },\r\n            priceSaved: {\r\n                $div: $('.price-section--saving', $scope),\r\n                $span: $('[data-product-price-saved]', $scope),\r\n            },\r\n            priceNowLabel: {\r\n                $span: $('.price-now-label', $scope),\r\n            },\r\n            priceLabel: {\r\n                $span: $('.price-label', $scope),\r\n            },\r\n            $weight: $('.productView-info [data-product-weight]', $scope),\r\n            $increments: $('.form-field--increments :input', $scope),\r\n            $addToCart: $('#form-action-addToCart', $scope),\r\n            $wishlistVariation: $('[data-wishlist-add] [name=\"variation_id\"]', $scope),\r\n            stock: {\r\n                $container: $('.form-field--stock', $scope),\r\n                $input: $('[data-product-stock]', $scope),\r\n            },\r\n            $sku: $('[data-product-sku]'),\r\n            $upc: $('[data-product-upc]'),\r\n            quantity: {\r\n                $text: $('.incrementTotal', $scope),\r\n                $input: $('[name=qty\\\\[\\\\]]', $scope),\r\n            },\r\n            $bulkPricing: $('.productView-info-bulkPricing', $scope),\r\n        };\r\n    }\r\n\r\n    function clearPricingNotFound(viewModel) {\r\n        viewModel.rrpWithTax.$div.hide();\r\n        viewModel.rrpWithoutTax.$div.hide();\r\n        viewModel.nonSaleWithTax.$div.hide();\r\n        viewModel.nonSaleWithoutTax.$div.hide();\r\n        viewModel.priceSaved.$div.hide();\r\n        viewModel.priceNowLabel.$span.hide();\r\n        viewModel.priceLabel.$span.hide();\r\n    }\r\n    /**\r\n     * Update the view of price, messages, SKU and stock options when a product option changes\r\n     * @param  {Object} data Product attribute data\r\n     */\r\n    function updatePriceView(viewModel, price) {\r\n        clearPricingNotFound(viewModel);\r\n\r\n        if (price.with_tax) {\r\n            viewModel.priceLabel.$span.show();\r\n            viewModel.$priceWithTax.html(price.with_tax.formatted);\r\n        }\r\n\r\n        if (price.without_tax) {\r\n            viewModel.priceLabel.$span.show();\r\n            viewModel.$priceWithoutTax.html(price.without_tax.formatted);\r\n        }\r\n\r\n        if (price.rrp_with_tax) {\r\n            viewModel.rrpWithTax.$div.show();\r\n            viewModel.rrpWithTax.$span.html(price.rrp_with_tax.formatted);\r\n        }\r\n\r\n        if (price.rrp_without_tax) {\r\n            viewModel.rrpWithoutTax.$div.show();\r\n            viewModel.rrpWithoutTax.$span.html(price.rrp_without_tax.formatted);\r\n        }\r\n\r\n        if (price.saved) {\r\n            viewModel.priceSaved.$div.show();\r\n            viewModel.priceSaved.$span.html(price.saved.formatted);\r\n        }\r\n\r\n        if (price.non_sale_price_with_tax) {\r\n            viewModel.priceLabel.$span.hide();\r\n            viewModel.nonSaleWithTax.$div.show();\r\n            viewModel.priceNowLabel.$span.show();\r\n            viewModel.nonSaleWithTax.$span.html(price.non_sale_price_with_tax.formatted);\r\n        }\r\n\r\n        if (price.non_sale_price_without_tax) {\r\n            viewModel.priceLabel.$span.hide();\r\n            viewModel.nonSaleWithoutTax.$div.show();\r\n            viewModel.priceNowLabel.$span.show();\r\n            viewModel.nonSaleWithoutTax.$span.html(price.non_sale_price_without_tax.formatted);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * https://stackoverflow.com/questions/49672992/ajax-request-fails-when-sending-formdata-including-empty-file-input-in-safari\r\n     * Safari browser with jquery 3.3.1 has an issue uploading empty file parameters. This function removes any empty files from the form params\r\n     * @param formData: FormData object\r\n     * @returns FormData object\r\n     */\r\n    function filterEmptyFilesFromForm(formData) {\r\n        try {\r\n            for (const [key, val] of formData) {\r\n                if (val instanceof File && !val.name && !val.size) {\r\n                    formData.delete(key);\r\n                }\r\n            }\r\n        } catch (e) {\r\n            console.error(e); // eslint-disable-line no-console\r\n        }\r\n        return formData;\r\n    }\r\n\r\n}\r\n"],"sourceRoot":""}